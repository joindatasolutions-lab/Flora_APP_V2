<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Flora - Módulo de Domicilios</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --rosa:#e6a5b6;
      --rosa-osc:#c97b94;
      --bg:#fdfaf7;
      --gris:#5c5c5c;
      --borde:#ecd6dc;
      --verde:#1a7f37;
      --amarillo:#a15d00;
    }
    *{ box-sizing:border-box; }
    body{
      font-family:'Inter',sans-serif;
      background:var(--bg);
      color:#333;
      margin:0;
      min-height:100vh;
      display:flex;
      flex-direction:column;
    }
    header{
      text-align:center;
      padding:20px 16px;
      background:#fff;
      border-bottom:1px solid var(--borde);
      box-shadow:0 2px 6px rgba(0,0,0,.05);
    }
    header img{ max-width:220px; height:auto; margin-bottom:6px; }
    header h2{ margin:8px 0 0; color:var(--gris); }

    .grid{
      display:grid;
      gap:12px;
      grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
      max-width:1100px;
      margin:20px auto;
      padding:0 12px;
    }
    .card{
      background:#fff;
      border:1px solid var(--borde);
      border-radius:18px;
      box-shadow:0 6px 18px rgba(0,0,0,.06);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      position:relative;
      transition:all .2s ease;
    }
    .card:hover{ transform:translateY(-3px); box-shadow:0 10px 24px rgba(0,0,0,.1); border-color:var(--rosa); }
    .card img{
      width:100%;
      height:180px;
      object-fit:cover;
      border-bottom:1px solid var(--borde);
    }
    .body{
      padding:12px;
      flex-grow:1;
    }
    .name{ font-weight:700; font-size:1rem; margin:0 0 4px; }
    .info{ font-size:.9rem; color:var(--gris); margin:2px 0; }
    .actions{
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:10px 12px;
      border-top:1px solid var(--borde);
      background:#fffafc;
    }
    select{
      padding:6px 8px;
      border:1px solid #ddd;
      border-radius:10px;
      font-size:.85rem;
    }
    .btn{
      border:none;
      border-radius:10px;
      padding:8px 12px;
      font-weight:700;
      cursor:pointer;
      color:#fff;
      font-size:.85rem;
    }
    .ruta{ background:var(--amarillo); }
    .entregado{ background:var(--verde); }
    .badge{
      position:absolute;
      top:10px;
      left:10px;
      padding:6px 10px;
      border-radius:999px;
      font-size:.8rem;
      font-weight:700;
      color:#fff;
    }
    .en-ruta{ background:var(--amarillo); }
    .entregado-badge{ background:var(--verde); }
    .pendiente{ background:var(--rosa-osc); }
  </style>
</head>
<body>
  <header>
    <img src="img/logo 2024 marca registrada-04.png" alt="FLORA Logo">
    <h2>Gestión de Domicilios</h2>
  </header>

  <section class="grid" id="domiciliosGrid"></section>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbws89d2Udmo9WpWjSCk0DexYjKlZ-T1Lz_8viX7NC0CVCSd9IzsHwpdGLyz0j5UVjeh/exec";

    // Ejemplo de datos simulados (pueden venir de Google Sheets)
    const domicilios = [
      {
        id: 1,
        producto: "Ramo Primavera",
        cliente: "María Gómez",
        direccion: "Cra 51 #86-30, Miramar",
        telefono: "3001234567",
        barrio: "Miramar",
        estado: "Pendiente",
        imagen: "https://via.placeholder.com/300x200?text=Ramo+Primavera"
      },
      {
        id: 2,
        producto: "Caja Floral Rosa",
        cliente: "Juan Pérez",
        direccion: "Calle 96 #72-10, Altos del Prado",
        telefono: "3019876543",
        barrio: "Altos del Prado",
        estado: "En Ruta",
        imagen: "https://via.placeholder.com/300x200?text=Caja+Floral+Rosa"
      }
    ];

    const domiciliarios = ["Elvis", "Oscar", "Externo"];

    function renderDomicilios(){
      const grid = document.getElementById("domiciliosGrid");
      grid.innerHTML = "";
      domicilios.forEach(dom => {
        const card = document.createElement("div");
        card.className = "card";

        const badgeClass =
          dom.estado === "En Ruta" ? "en-ruta" :
          dom.estado === "Entregado" ? "entregado-badge" : "pendiente";

        card.innerHTML = `
          <span class="badge ${badgeClass}">${dom.estado}</span>
          <img src="${dom.imagen}" alt="${dom.producto}" onerror="this.src='https://via.placeholder.com/300x200?text=Sin+imagen';">
          <div class="body">
            <div class="name">${dom.producto}</div>
            <div class="info"><strong>Cliente:</strong> ${dom.cliente}</div>
            <div class="info"><strong>Dirección:</strong> ${dom.direccion}</div>
            <div class="info"><strong>Barrio:</strong> ${dom.barrio}</div>
            <div class="info"><strong>Teléfono:</strong> ${dom.telefono}</div>
          </div>
          <div class="actions">
            <select>
              <option value="">Asignar domiciliario</option>
              ${domiciliarios.map(d => `<option value="${d}">${d}</option>`).join("")}
            </select>
            <div>
              <button class="btn ruta">En Ruta</button>
              <button class="btn entregado">Entregado</button>
            </div>
          </div>
        `;

        // Eventos
        const btnRuta = card.querySelector(".ruta");
        const btnEntregado = card.querySelector(".entregado");
        const badge = card.querySelector(".badge");

        btnRuta.addEventListener("click", () => actualizarEstado(dom, "En Ruta", badge));
        btnEntregado.addEventListener("click", () => actualizarEstado(dom, "Entregado", badge));

        grid.appendChild(card);
      });
    }

    function actualizarEstado(dom, nuevoEstado, badge){
      dom.estado = nuevoEstado;
      badge.textContent = nuevoEstado;
      badge.className = `badge ${nuevoEstado === "En Ruta" ? "en-ruta" : "entregado-badge"}`;
      // Lógica para actualizar en Google Sheets
      fetch(SCRIPT_URL, {
        method: "POST",
        body: JSON.stringify({ action: "updateEstado", id: dom.id, estado: nuevoEstado }),
        headers: { "Content-Type": "application/json" }
      });
    }

    renderDomicilios();
  </script>
</body>
</html>
